2025-12-24 17:24:40.529 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:24:40.530 [main] INFO  com.viettel.sync.app.Main -        BẮT ĐẦU TOOL ĐỒNG BỘ DỮ LIỆU       
2025-12-24 17:24:40.531 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:24:40.533 [main] INFO  com.viettel.sync.app.Main - Schema Source: DATALAKE_CONFIG
2025-12-24 17:24:40.534 [main] INFO  com.viettel.sync.app.Main - Schema Target: DATALAKE_CONFIG_TD
2025-12-24 17:24:41.010 [main] INFO  c.viettel.sync.service.SyncService - ========== BẮT ĐẦU ĐỒNG BỘ (FINAL VERSION) ==========
2025-12-24 17:24:41.010 [main] INFO  c.viettel.sync.service.SyncService - --- 1. SYNC TIME PARAM ---
2025-12-24 17:24:41.201 [main] INFO  c.viettel.sync.service.SyncService - --- 2. SYNC CONNECTIONS ---
2025-12-24 17:24:41.391 [main] WARN  c.viettel.sync.service.SyncService - ⚠️ PHÁT HIỆN 1 XUNG ĐỘT/VẤN ĐỀ:
2025-12-24 17:24:41.392 [main] WARN  c.viettel.sync.service.SyncService - ⚠️ CONFLICT ID 921: JDBC Auth Diff
2025-12-24 17:24:41.406 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 274 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_CONNECTION
2025-12-24 17:24:41.406 [main] INFO  c.viettel.sync.service.SyncService -    -> [DELETE] Đã xóa 274 connection cũ.
2025-12-24 17:24:41.431 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 274 dòng vào bảng DATALAKE_CONFIG_TD.D_CONNECTION
2025-12-24 17:24:41.431 [main] INFO  c.viettel.sync.service.SyncService -    -> [INSERT/UPDATE] Đã ghi 274 connection.
2025-12-24 17:24:41.457 [main] INFO  c.viettel.sync.service.SyncService - Danh sách ID thuộc nhóm fix [2024, 1229, 13, 15, 2000, 16, 17, 18, 19, 20, 22, 23, 24, 921]
2025-12-24 17:24:41.457 [main] INFO  c.viettel.sync.service.SyncService - --- 3. SYNC PIPELINE (Auto Drop & Clean Logic) ---
2025-12-24 17:24:42.184 [main] INFO  c.viettel.sync.service.SyncService -    -> Safe Items: Cmd=66, Cfg=68, Create=61
2025-12-24 17:24:42.236 [main] INFO  c.v.sync.core.GenericRepository -    -> [TRUNCATE] Đã làm sạch bảng DATALAKE_CONFIG_TD.D_CLEAN_FOLDER
2025-12-24 17:24:42.256 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1128 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_CONFIG
2025-12-24 17:24:42.293 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1130 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND
2025-12-24 17:24:42.342 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1842 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND_CREATE
2025-12-24 17:24:42.343 [main] INFO  c.v.sync.repository.SourceRepository - Executing Pipeline Query (Active Only)...
2025-12-24 17:24:42.792 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 100022 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/mps/media/f_mps_media_transaction_mpi/mon=${YYMM:DD-1}/partition=${YYYYMMDD:DD-1}
2025-12-24 17:24:42.796 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 504 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_vaspgw_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:24:42.800 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 88 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/mps/f_mps_transaction_mpi/mon=${YYMM:DD-1}/partition=${YYYYMMDD:DD-1}
2025-12-24 17:24:42.802 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 801 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_activity_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:24:42.802 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 802 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_gem_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:24:42.804 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10321 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/payment/billing/f_billing_import_red_alert_list/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:24:42.805 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10228 - Path quá phức tạp (>1 biến $): /work_zone/datalake/datalake_config/f_datalake_running_process/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:24:42.805 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10229 - Path quá phức tạp (>1 biến $): /work_zone/datalake/datalake_config/f_datalake_log_export_ftp/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:24:42.812 [main] INFO  c.viettel.sync.service.SyncService -    -> Global Path Map: 1054 entries
2025-12-24 17:24:53.342 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1130 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND
2025-12-24 17:24:53.372 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1128 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_CONFIG
2025-12-24 17:24:53.479 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1842 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND_CREATE
2025-12-24 17:24:53.495 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 947 dòng vào bảng DATALAKE_CONFIG_TD.D_CLEAN_FOLDER
2025-12-24 17:24:53.495 [main] INFO  c.viettel.sync.service.SyncService -    -> [INSERT NEW] Cmd=1130, Cfg=1128, Create=1842, Clean=947
2025-12-24 17:24:53.495 [main] INFO  c.viettel.sync.service.SyncService -    -> [POST-PROCESS] Linking Auto-Generated Clean & Drop Commands...
2025-12-24 17:24:54.054 [main] INFO  c.viettel.sync.service.SyncService -    -> [LINKED] Đã cập nhật liên kết cho 947 bản ghi Clean.
2025-12-24 17:24:54.057 [main] INFO  c.viettel.sync.service.SyncService - ✅ ĐỒNG BỘ THÀNH CÔNG TOÀN BỘ!
2025-12-24 17:24:54.060 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:24:54.060 [main] INFO  com.viettel.sync.app.Main -           KẾT THÚC CHƯƠNG TRÌNH           
2025-12-24 17:24:54.060 [main] INFO  com.viettel.sync.app.Main -        Tổng thời gian: 13532 ms (13.532 giây)
2025-12-24 17:24:54.060 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:40:45.262 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:40:45.263 [main] INFO  com.viettel.sync.app.Main -        BẮT ĐẦU TOOL ĐỒNG BỘ DỮ LIỆU       
2025-12-24 17:40:45.263 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:40:45.266 [main] INFO  com.viettel.sync.app.Main - Schema Source: DATALAKE_CONFIG
2025-12-24 17:40:45.267 [main] INFO  com.viettel.sync.app.Main - Schema Target: DATALAKE_CONFIG_TD
2025-12-24 17:40:45.749 [main] INFO  c.viettel.sync.service.SyncService - ========== BẮT ĐẦU ĐỒNG BỘ (FINAL VERSION) ==========
2025-12-24 17:40:45.749 [main] INFO  c.viettel.sync.service.SyncService - --- 1. SYNC TIME PARAM ---
2025-12-24 17:40:45.931 [main] INFO  c.viettel.sync.service.SyncService - --- 2. SYNC CONNECTIONS ---
2025-12-24 17:40:46.115 [main] WARN  c.viettel.sync.service.SyncService - ⚠️ PHÁT HIỆN 1 XUNG ĐỘT/VẤN ĐỀ:
2025-12-24 17:40:46.116 [main] WARN  c.viettel.sync.service.SyncService - ⚠️ CONFLICT ID 921: JDBC Auth Diff
2025-12-24 17:40:46.128 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 274 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_CONNECTION
2025-12-24 17:40:46.129 [main] INFO  c.viettel.sync.service.SyncService -    -> [DELETE] Đã xóa 274 connection cũ.
2025-12-24 17:40:46.154 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 274 dòng vào bảng DATALAKE_CONFIG_TD.D_CONNECTION
2025-12-24 17:40:46.154 [main] INFO  c.viettel.sync.service.SyncService -    -> [INSERT/UPDATE] Đã ghi 274 connection.
2025-12-24 17:40:46.180 [main] INFO  c.viettel.sync.service.SyncService - Danh sách ID thuộc nhóm fix [2024, 1229, 13, 15, 2000, 16, 17, 18, 19, 20, 22, 23, 24, 921]
2025-12-24 17:40:46.180 [main] INFO  c.viettel.sync.service.SyncService - --- 3. SYNC PIPELINE (Auto Drop & Clean Logic) ---
2025-12-24 17:40:46.864 [main] INFO  c.viettel.sync.service.SyncService -    -> Safe Items: Cmd=66, Cfg=68, Create=61
2025-12-24 17:40:46.884 [main] INFO  c.v.sync.core.GenericRepository -    -> [TRUNCATE] Đã làm sạch bảng DATALAKE_CONFIG_TD.D_CLEAN_FOLDER
2025-12-24 17:40:46.903 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1128 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_CONFIG
2025-12-24 17:40:46.928 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1130 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND
2025-12-24 17:40:46.966 [main] INFO  c.v.sync.core.GenericRepository -    -> [DELETE] Đã xóa 1842 dòng rác khỏi bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND_CREATE
2025-12-24 17:40:46.967 [main] INFO  c.v.sync.repository.SourceRepository - Executing Pipeline Query (Active Only)...
2025-12-24 17:40:47.405 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 100022 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/mps/media/f_mps_media_transaction_mpi/mon=${YYMM:DD-1}/partition=${YYYYMMDD:DD-1}
2025-12-24 17:40:47.408 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 504 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_vaspgw_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:40:47.412 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 88 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/mps/f_mps_transaction_mpi/mon=${YYMM:DD-1}/partition=${YYYYMMDD:DD-1}
2025-12-24 17:40:47.415 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 801 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_activity_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:40:47.415 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 802 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/vas/vaspgw/f_gem_voice_brandname_sub/temp/${YYYYMMDD}/${YYYYMMDDHH24MMSS}
2025-12-24 17:40:47.417 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10321 - Path quá phức tạp (>1 biến $): /raw_zone/telecom/vtt/payment/billing/f_billing_import_red_alert_list/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:40:47.418 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10228 - Path quá phức tạp (>1 biến $): /work_zone/datalake/datalake_config/f_datalake_running_process/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:40:47.418 [main] WARN  c.v.sync.service.DataTransformer - ⚠️ Skip Config ID 10229 - Path quá phức tạp (>1 biến $): /work_zone/datalake/datalake_config/f_datalake_log_export_ftp/partition=${YYYYMMDD:HH-1}/hour=${HH:HH-1}
2025-12-24 17:40:47.425 [main] INFO  c.viettel.sync.service.SyncService -    -> Global Path Map: 1054 entries
2025-12-24 17:41:02.980 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1130 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND
2025-12-24 17:41:03.011 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1128 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_CONFIG
2025-12-24 17:41:03.127 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 1842 dòng vào bảng DATALAKE_CONFIG_TD.D_DB_2_HDFS_COMMAND_CREATE
2025-12-24 17:41:03.142 [main] INFO  c.v.sync.core.GenericRepository -    -> [INSERT] Đã chèn 947 dòng vào bảng DATALAKE_CONFIG_TD.D_CLEAN_FOLDER
2025-12-24 17:41:03.143 [main] INFO  c.viettel.sync.service.SyncService -    -> [INSERT NEW] Cmd=1130, Cfg=1128, Create=1842, Clean=947
2025-12-24 17:41:03.143 [main] INFO  c.viettel.sync.service.SyncService -    -> [POST-PROCESS] Linking Auto-Generated Clean & Drop Commands...
2025-12-24 17:41:03.617 [main] INFO  c.viettel.sync.service.SyncService -    -> [LINKED] Đã cập nhật liên kết cho 947 bản ghi Clean.
2025-12-24 17:41:03.621 [main] INFO  c.viettel.sync.service.SyncService - ✅ ĐỒNG BỘ THÀNH CÔNG TOÀN BỘ!
2025-12-24 17:41:03.623 [main] INFO  com.viettel.sync.app.Main - ==========================================
2025-12-24 17:41:03.623 [main] INFO  com.viettel.sync.app.Main -           KẾT THÚC CHƯƠNG TRÌNH           
2025-12-24 17:41:03.623 [main] INFO  com.viettel.sync.app.Main -        Tổng thời gian: 18362 ms (18.362 giây)
2025-12-24 17:41:03.623 [main] INFO  com.viettel.sync.app.Main - ==========================================
